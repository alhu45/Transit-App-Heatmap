How the pieces tie together (dataflow)
Load CSV → df
Normalize station/line/day strings
Build X,y → parse hours/minutes → drop NaNs → mask to service hours
Pipeline.fit on X_train,y_train
clean_df adds tod_sin/cos and normalizes strings
ColumnTransformer builds the design matrix
LinearRegression learns weights
Evaluate on X_test
Save model + metadata
Visualize predicted hourly profile for chosen station/day
Think of it as: Raw DF → time cleanup → keep only sensible times → (clean_df → encode) → regress → save & plot.